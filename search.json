[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Digitalizing Mobility Braga",
    "section": "",
    "text": "Início\nMateriais e dados para a aula de GTFS e outros dados abertos para planeamento de transportes, módulo do workshop Digitalizing Mobility - T.U. Berlin goes to Braga do EIT Urban Mobility.\n\n \n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\nNota\n\n\n\nEste website foi totalmente desenvolvido em R com Quarto.",
    "crumbs": [
      "Início"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "Planeamento",
    "section": "",
    "text": "GTFS e outros dados abertos para planeamento de transportes",
    "crumbs": [
      "Planeamento"
    ]
  },
  {
    "objectID": "summary.html#gtfs-e-outros-dados-abertos-para-planeamento-de-transportes",
    "href": "summary.html#gtfs-e-outros-dados-abertos-para-planeamento-de-transportes",
    "title": "Planeamento",
    "section": "",
    "text": "Os dados abertos em mobilidade e transportes\nExemplos nacionais e internacionais de análises com dados abertos\nIntrodução ao GTFS\nFontes de dados GTFS e tratamento\nAcessibilidade espacial em R",
    "crumbs": [
      "Planeamento"
    ]
  },
  {
    "objectID": "open-data.html",
    "href": "open-data.html",
    "title": "1  Dados Abertos em transportes",
    "section": "",
    "text": "1.1 Pontos de Acesso Nacionais (NAP)\nA União Europeia define Dados Abertos como:\nOutras vantagens e benefícios da partilha de dados são:\nA União Europeia estima que o valor económico da partilha e utilização de dados abertos chegue a 194 mil milhões € em 2030.\nNeste capítulo, vamos guiá-lo através das fontes de dados abertos para a análise dos transportes: redes rodoviárias e informações sobre os transportes públicos.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Dados Abertos em transportes</span>"
    ]
  },
  {
    "objectID": "open-data.html#pontos-de-acesso-nacionais-nap",
    "href": "open-data.html#pontos-de-acesso-nacionais-nap",
    "title": "1  Dados Abertos em transportes",
    "section": "",
    "text": "1.1.1 União Europeia\nA diretiva ITS da Comissão Europeia (2010/40/EU) recomenda aos Estados-Membros que forneçam acesso a dados sobre transportes, de acordo com os stardards definidos pela CE. Os dados incluem não só dados sobre transportes públicos, mas também redes rodoviárias, parques de estacionamento e outras informações relacionadas com transportes.\nList of the European Union members states with National Access Points for Transportation data\nExemplo dos dados de serviços de autocarro na Bélgica:\n\n\n\nFonte: Transport Data Belgium\n\n\n\n\n1.1.2 Portugal\n\nNAP\nEm Portugal, o NAP encontra-se em https://nap-portugal.imt-ip.pt\n\n\n\n\n\n\n\nTPC\n\n\n\n\nEncontrar os dados dos parques de estacionamento municipais do Porto.\nEncontrar e descarregar os dados GTFS da Carris Metropolitana\n\n\n\n\n\nPortal de dados abertos\nO portal dados.gov.pt é a plataforma oficial nacional de partilha de dados institucionais.\nAlguns websites de dados abertos de municípios também incluem dados de mobilidade e transportes, como é o caso de:\n\nDados Abertos da Câmara Municipal de Lisboa\nDados Abertos da Câmara Municipal de Cascais\nDados Abertos da Câmara Municipal de Oeiras\nDados Abertos da Câmara Municipal do Porto\n\n\n\n\nFonte: data.cascais.pt\n\n\nCada vez mais, os dados de transporte disponibilizados estão georreferenciados - i.e., é possível serem visualizados num mapa.\nAlgumas instituições permitem o download dos dados, e outros apenas a visualização dos mesmos em mapas ou dashboards interativas.\nAs boas práticas recomendam que os dados venham acompanhados de metadados, que incluem toda a informação relevante sobre os dados (ex: explicação dos acrónimos de variáveis usadas).\nOutras informações que acompanham os dados abertos são:\n\nDescrição\nFormato\nPeríodo temporal\nVersão\nData da última atualização\nResponsável pela manutenção dos dados e contacto\n\n\n\n\nExemplo de informação complementar de dados de Praças de Táxis (Cascais)\n\n\nDados de operação (passageiros, bilhética, volumes de tráfego, entre outros) normalmente não são disponibilizados ao público.\nPor vezes, alguma dessa informação é incluída, de forma agregada, nos relatórios anuais de sustentabilidade das operadoras.\n\n\n\n\n\n\nQuestão\n\n\n\nEnumere motivos para este tipo de dados não ser, normalmente, de acesso aberto.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Dados Abertos em transportes</span>"
    ]
  },
  {
    "objectID": "open-data.html#boas-práticas-de-dados-abertos",
    "href": "open-data.html#boas-práticas-de-dados-abertos",
    "title": "1  Dados Abertos em transportes",
    "section": "1.2 Boas práticas de dados abertos",
    "text": "1.2 Boas práticas de dados abertos\nO Open Data Institute publica vários guias de boas práticas de partilha e uso de dados abertos, tais como validação de veracidade dos dados, anonimização de dados, avaliação dos riscos de partilha de dados, ética e responsabilidade, estimativa do valor dos dados partilhados, entre outros.\nOs dados abertos são publicados sob licenças específicas, não incluem dados pessoais, informação sensível e/ou confidencial.\nPor omissão, o dados.gov usa a licença CC BY 4.0 (Creative Commons Attribution 4.0), que pressupõe a menção da fonte original dos dados, mas possibilita qualquer tipo de uso.\nAlgumas questões devem ser consideradas ao usar um conjunto de dados abertos (The Open Data Institute 2013):\nFormato\n\nComo foram processados os dados?\nEstão em estado bruto (raw) ou foram processados?\nDe que modo o seu formato (e granularidade) irá afetar a sua análise/produto/aplicação?\nQue transformações sintáticas (linguagem) e semânticas (significado) serão necessárias?\nEstes dados são compatíveis com outros conjuntos de dados de que dispõe?\n\nQualidade\n\nAté que ponto os dados são atuais?\nCom que frequência são atualizados?\nCompreende todos os campos e o seu contexto?\nDurante quanto tempo serão publicados? Qual é o compromisso com o publicador?\nO que sabe sobre a exatidão dos dados?\nComo são tratados os dados omissos?\n\nAlguns dados abertos fornecem um API (Application Programming Interface) para que se possa automativamente chamar os dados mais autualizados disponíveis.\n\n1.2.1 Tutoriais\nO ISCTE, no âmbito do Plano Nacional de Administração Aberta, criou um conjunto de vídeos tutoriais sobre algumas possibilidades da reutilização de dados, utilizando o R.\n\n\n\nCurso gratuito sobre a utilização de plataformas de dados abertos (Português), do ISCTE\n\n\nA AMA - Agência para a Modernização Administrativa disponibiliza também alguns vídeos sobre como usar o portal de dados abertos. Chamo a atenção para o “Como publicar dados abertos”, acessível a qualquer entidade.\n\n\n\n1.2.2 Reutilização de dados abertos\nQualquer pessoa ou entidade pode aceder a dados abertos (por definição). É recomendado, como boa prática, a partilha dos resultados que se obtiveram com a utilização de um conjunto de dados abertos. Tal permite inspirar outros utilizadores dos dados, bem como dar conhecimento à entidade que os partilhou trabalhos que podem ser realizados com esses dados - levando muitas vezes à descoberta de novas prespetivas sobre os dados.\nAs reutilizações documentadas muitas vezes também partilham o código utilizado para tratamento e análise do conjunto de dados, permitindo a sua replicabilidade e adaptação / aplicação a outros contextos.\nExemplos de trabalhos realizados por reutilização de dados abertos:\n\nDados.gov.pt\n\n\n\nLxDataLab\n\n\n\nResultados de um desafio LxDataLab",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Dados Abertos em transportes</span>"
    ]
  },
  {
    "objectID": "open-data.html#exemplos-internacionais",
    "href": "open-data.html#exemplos-internacionais",
    "title": "1  Dados Abertos em transportes",
    "section": "1.3 Exemplos internacionais",
    "text": "1.3 Exemplos internacionais\n\n1.3.1 STATS19\nO Departamento de Transportes do Reino Unido (DfT) mantém uma importante base de dados com acidentes e colisões rodoviárias para todo o território - o STATS19, contendo dados uniformizados desde 1926 (centenas de milhares), que têm vindo a ser registados pela Polícia.\nEsta base de dados abertos é amplamente usada para definição de políticas públicas de segurança rodviária, e na academia, com a elaboração de vários dashbors e estudos que utilizam os dados. Exemplo:\n\nInteractive dashboard\nCollision map\nVision Zero public map\nBikedata - Compilação de vários dados de mobilidade urbana, incluindo colisões por tipo, contagens de tráfego. Os dados podem ser filtrados e exportados.\nstats19 - Pacote R com todos os dados pré-tratados.\n\n\n\n\nCollision Map em Leeds (UK)\n\n\n\n\n\nBikedata: compilação de vários dados relativos à circulação em bicicicleta\n\n\n\n\n\nPainel interativo do DfT para os dados de acidentes rodoviários\n\n\n\n\n1.3.2 Táxis em Nova Iorque\nA comissão de Táxis de Nova York (Taxi & Limousine Commission) partilha todos os dados de viagens realizadas desde 2009.\nOs dados incluem localização de origem e destino, data e hora, distância de viagem, tarifa, tipo de pagamento, e número de passegeiros transportados.\nTodos os anos, são realizadas várias análises a este conjunto de dados por alunos, investigadores, programadores, etc, que permitem uma análise detalhada e visualização espacial de padrões de mobilidade de táxis.\nExemplo 1 | Exemplo 2 | Exemplo 3 | Examplo 4 | Exemplo 5\n\n\n\nDashboard interativo de análise de dados de táxis em NY. Fonte: Github.\n\n\n\n\n\nDashboard interativo com viagens de táxi em 2018\n\n\n\n\n\nMapa interativo de localização de origens e destinos de viagens\n\n\n\n\n\n\n\n\nQuestões\n\n\n\n\nQue vantagens vê na utilização de dados abertos?\nQue dados a sua instituição poderia partilhar em acesso aberto?\nQue vantagens vê na abertura de dados para a sua instituição?\n\n\n\nNo capítulo seguinte iremos explorar o que são dados GTFS e como podem ser usados.\n\n\n\n\n\n\nThe Open Data Institute. 2013. Guide: The Open Data Consumer Checklist. https://theodi.org/insights/guides/the-open-data-consumer-checklist/.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Dados Abertos em transportes</span>"
    ]
  },
  {
    "objectID": "gtfs.html",
    "href": "gtfs.html",
    "title": "2  GTFS",
    "section": "",
    "text": "2.1 GTFS-Schedule\nO General Transit Feed Specification (GTFS) é um formato normalizado de dados abertos para documentar informações sobre transportes públicos, incluindo: itinerários, horários, localizações de paragens, padrões de calendário, viagens e possíveis transbordos. As operadoras de transporte público são responsáveis por manter os dados actualizados1.\nOs dados GTFS são utilizados em várias aplicações, como o Google Maps, City Mapper, entre outros, para fornecer direcções de transportes públicos. Podem ser disponibilizadas para uma cidade, uma região ou mesmo um país inteiro, dependendo da operadora de TP.\nOs dados encontram-se num ficheiro .zip que inclui vários ficheiros .txt (um para cada tipo de informação) com relações tabulares (campos comuns). Os mesmos podem ser facilmente editados em qualquer computador.\nOs GTFS podem ser estáticos (ou agendados / schedule) - por exemplo para viagens tabeladas, ou em tempo real (real time) - inclui mais informação, tal como posicionamento em tempo real.\nO GTFS Schedule é uma especificação que define um formato comum para informações estáticas sobre transportes públicos (agendadas, ou que não alteram dinamicamente).\nCada ficheiro descreve informação sobre transportes, como paragens, percursos, viagens, etc. Na sua forma mais simples, um conjunto de dados GTFS é composto por 7 ficheiros:",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>GTFS</span>"
    ]
  },
  {
    "objectID": "gtfs.html#gtfs-schedule",
    "href": "gtfs.html#gtfs-schedule",
    "title": "2  GTFS",
    "section": "",
    "text": "agency.txt\nroutes.txt\ntrips.txt\nstops.txt\nstop_times.txt\ncalendar.txt\ncalendar_dates.txt",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>GTFS</span>"
    ]
  },
  {
    "objectID": "gtfs.html#gtfs-realtime",
    "href": "gtfs.html#gtfs-realtime",
    "title": "2  GTFS",
    "section": "2.2 GTFS-Realtime",
    "text": "2.2 GTFS-Realtime\nOs GTFS Realtime é uma norma que permite às operadoras de transportes públicos fornecer informações actualizadas sobre as horas de chegada e partida, alertas de serviço e posição dos veículos, permitindo aos utilizadores planear as suas viagens com maior detalhe, incluindo por exemplo os seguintes tipos de informação:\n\nActualizações de viagens - atrasos, cancelamentos, alteração de itinerários\nAlertas de serviço - paragens deslocadas, acontecimentos imprevistos que afectem uma estação, um itinerário ou toda a rede\nPosições dos veículos - informações sobre os veículos, incluindo a localização e o nível de ocupação do interior do veículo\n\nUm exemplo de GTFS-Realtime são os dados da Carris Metropolitana.\n\n\n\nPlaneador de percursos em tempo real da Carris Metropolitana.\n\n\n\n\n\nPosicionamento em tempo real de autocarros Carris com passagem no Saldanha. Fonte: Google Maps\n\n\n\n2.2.1 Fontes online de dados GTFS\nOs seguintes websites incluem vários GTFS de operadoras, a nível mundial. Uma vantagem destes agregadores de dados é que muitas vezes também disponibilizam versões por data - útil para análises do ano X.\n\nTransitLand\nMobility Database\n\nAlgumas operadoras de Transporte Público nacionais também disponibilizam os seus dados abertos nos websites. (Ver NAP Portugal)\n\n\n\n\n\n\nPodemos juntar vários GTFS.zip num único MegaGTFS.zip",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>GTFS</span>"
    ]
  },
  {
    "objectID": "gtfs.html#netex",
    "href": "gtfs.html#netex",
    "title": "2  GTFS",
    "section": "2.3 NeTEX",
    "text": "2.3 NeTEX\nOutro formato semelhande ao GTFS é o NeTEX (Network Timetable EXchange). Este também é usado por algumas operadoras de TP em Portugal.\n\nO NeTEx está dividido em seis partes, cada uma abrangendo um subconjunto funcional do Transmodelo CEN para Informação sobre Transportes Públicos:\n\nParte 1: Descreve a topologia da rede de transportes públicos (CEN/TS 16614-1:2014)\nParte 2: Descreve os horários agendados (CEN/TS 16614-2:2014)\nParte 3: Informação tarifária (CEN/TS 16614-3:2015)\nParte 4: Perfil Europeu de Informação de Passageiros - EPIP (CEN/TS 16614-4:2017)\nParte 5: Formato de intercâmbio de modos alternativos (CEN/TS 16614-5:2021)\nParte 6: Perfil Europeu de Acessibilidade às Informações de Passageiros - EPIAP (CEN/TS 16614-6:2024)\n\nOs dados NeTEX usam o formato .xml, o que pode tornar a informação mais difícil de ler ou editar.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>GTFS</span>"
    ]
  },
  {
    "objectID": "gtfs.html#gbfs",
    "href": "gtfs.html#gbfs",
    "title": "2  GTFS",
    "section": "2.4 GBFS",
    "text": "2.4 GBFS\nPara dados de sistemas de mobilidade partilhada e micromobilidade, há ainda o General Bicycle Feed Specification (GBFS).\nTal como os GTFS, os GBFS são dados normalizados com toda a informação sobre os sistemas partilhados, e incluem informações sobre os veículos (bicicletas, trotinetas, motociclos e automóveis), docas, preços, entre outros:\n\nLocalização e disponibilidade de veículos, estações e docas\nCaraterísticas do veículo - tipo de energia, distância que ainda pode ser percorrida\nPreços do serviço e condições de aluguer\nÁreas delimitadas geograficamente para regras relacionadas com velocidade permitida, estacionamento e zonas proibidas\n\nOs dados GBFS são utilizados por aplicações de planeamento de viagens e de Mobilidade como Serviço (MaaS), para fornecer as informações de que os utilizadores necessitam para utilizar a mobilidade partilhada.\nAs APIs públicas do GBFS facilitam a integração de serviços de mobilidade partilhada com os transportes públicos, permitindo que os utilizadores façam intermodalidade - ligações entre a primeira e a última milha.\nAlém disso, o GBFS fornece aos municípios e operadoras uma forma padronizada de recolher, analisar e comparar dados gerados pelos sistemas de mobilidade partilhada.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>GTFS</span>"
    ]
  },
  {
    "objectID": "gtfs.html#footnotes",
    "href": "gtfs.html#footnotes",
    "title": "2  GTFS",
    "section": "",
    "text": "Dados de operadora de transportes que não estejam atualizados poderão levar a uma péssima experiência ao utilizador, uma vez que a realidade não corresponde às expetativas criadas pelos dados (desatualizados).↩︎",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>GTFS</span>"
    ]
  },
  {
    "objectID": "gtfs_exercise.html",
    "href": "gtfs_exercise.html",
    "title": "3  Análise de GTFS",
    "section": "",
    "text": "3.1 Pacotes de R\nExistem alguns bons pacotes R para ler e manipular dados GTFS, tais como:",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Análise de GTFS</span>"
    ]
  },
  {
    "objectID": "gtfs_exercise.html#pacotes-de-r",
    "href": "gtfs_exercise.html#pacotes-de-r",
    "title": "3  Análise de GTFS",
    "section": "",
    "text": "tidytransit\ngtfstools\ngtfsio\ngtfsrouter - útil para criar tabela transfers.txt quando não existe.\ngeotransit - para descarregar todos os GTFS presentes numa determinada área\nGTFSwizard - análises rápidas e interativas\nGTFShift - análises de frequências para planeamento\n\n\n\n\n\n\n\nAtenção que os pacotes podem partilhar os mesmos nomes de funções, pelo que é importante utilizar um delas de cada vez.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Análise de GTFS</span>"
    ]
  },
  {
    "objectID": "gtfs_exercise.html#exemplo-de-análise-gtfs-em-r",
    "href": "gtfs_exercise.html#exemplo-de-análise-gtfs-em-r",
    "title": "3  Análise de GTFS",
    "section": "3.2 Exemplo de análise GTFS em R",
    "text": "3.2 Exemplo de análise GTFS em R\n\n3.2.1 Metro Lisboa\nVamos importar os dados de GTFS diretamente do website do Metro de Lisboa\n\n\nCódigo\n## Pacotes\nlibrary(tidyverse)\nlibrary(tidytransit)\nlibrary(mapview)\n\n# Ler dados GTFS\nMETRO = read_gtfs(\"https://github.com/rosamfelix/EITbraga/releases/download/latest/metro_gtfs.zip\")\nsummary(METRO)\n\n\ntidygtfs object\nfiles        agency, stops, routes, trips, stop_times, calendar, calendar_dates, fare_attributes, fare_rules, frequencies, transfers, feed_info\nagency       Metropolitano de Lisboa, E.P.E.\nservice      from 2023-04-02 to 2031-12-31\nuses         stop_times (no frequencies)\n# routes        4\n# trips      2514\n# stop_ids     74\n# stop_names   50\n# shapes        0\n\n\nEste ficheiro inclui as transferências, mas não inclui as shapes. Neste caso não é relevante, elas podem ser depois geradas com a informação que já existe.\nPodemos ver a localização das 50 estações do Metro:\n\n\nCódigo\nESTACOES_metro = stops_as_sf(METRO$stops) # converter texto para geometria\nmapview(ESTACOES_metro)\n\n\n\n\n\n\nDesafio: Ver quanto tempo demora a alcançar cada estação a partir da Baixa\n\nnum dia útil em hora de ponta\nnum domingo de noite\n\n\nDia útil em hora de ponta\nFiltramos os dados para o dia de hoje, terça-feira, entre as 7h30 e as 9h00, e calculamos a duração da viagem mais rápida entre a estação Baixa-Chiado e todas as outras.\n\n\nCódigo\nstop_times_metro = filter_stop_times(METRO, \"2025-05-28\", \"07:30:00\", \"09:00:00\")\nduracao_viagem = travel_times(stop_times_metro, \"Baixa / Chiado\") # Baixa / Chiado é a estação de metro da Baixa\n\nsummary(duracao_viagem$travel_time/60) # resumo em minutos\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   6.383  13.417  12.945  18.904  26.667 \n\n\nSem contar com o tempo de espera na Baixa-Chiado, é possível alcançar qualquer estação da rede em menos de 26.7 minutos, em hora de ponta.\n\n\nDomingo de noite\nFiltramos os dados para o próximo Domingo entre as 21h30 e as 22h30, e novamente calculamos a duração da viagem mais rápida entre a estação Baixa-Chiado e todas as outras\n\n\nCódigo\nstop_times_metro = filter_stop_times(METRO, \"2025-06-01\", \"21:30:00\", \"22:30:00\")\nduracao_viagem = travel_times(stop_times_metro, \"Baixa / Chiado\") \n\nsummary(duracao_viagem$travel_time/60) # resumo em minutos\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   6.321  15.675  14.358  21.846  29.983 \n\n\nNum Domingo de noite, é possível alcançar qualquer estação da rede em menos de 29.9 minutos.\n\n\nVisualizar dados num mapa\nPodemos criar um gráfico que mostre o tempo que cada estação demora a alcançar, a partir da Baixa-Chiado.\nJuntamos primeiro os tempos estimados aos dados georreferenciados das estações\n\n\nCódigo\nduracao_viagem_BC_HP = ESTACOES_metro |&gt; \n  left_join(duracao_viagem, by = c(\"stop_id\" = \"to_stop_id\")) |&gt;  # juntar os dados às estaçoes\n  filter(!is.na(travel_time)) # remover as plataformas não usadas\n\n\nE “colorimos” o tempo de viagem que demora (no mínímo) a alcançar cada estação\n\n\nCódigo\n##| code-summary: \"Mostrar código\"\nggplot(duracao_viagem_BC_HP) +\n  geom_sf(aes(color = travel_time/60)) +\n  ggtitle(\"Alcance desde a estação Baixa-Chiado (Metro)\",\n          subtitle = \"às 7h30 de Terça, 28 Maio 2025\") +\n  labs(color = \"Tempo de viagem [min]\") +\n  geom_sf(data = LisboaGEO, # limite Lisboa\n          fill = \"transparent\",\n          color = \"grey30\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\n\n\n\n3.2.2 Transportes Urbanos de Braga (TUB)\nPodemos fazer o mesmo exercício com os dados dos TUB. O ficheiro original não inclui o transfers.txt, e foi gerado automaticamente um com a função gtfsrouter::gtfs_transfer_table()\n\n\nCódigo\n# Ler dados GTFS\nTUB = read_gtfs(\"https://github.com/rosamfelix/EITbraga/releases/download/latest/tub_gtfs.zip\")\nsummary(TUB)\n\n\ntidygtfs object\nfiles        agency, stops, routes, trips, stop_times, calendar, calendar_dates, fare_attributes, fare_rules, shapes, transfers\nagency       Transportes Urbanos de Braga\nservice      from 2012-12-25 to 2025-11-12\nuses         stop_times (no frequencies)\n# routes       78\n# trips      3601\n# stop_ids   1980\n# stop_names 1192\n# shapes      395\n\n\nEste ficheiro já inclui as transferências, e também as rotas (shapes).\nPodemos ver a localização das 1980 paragens dos TUB:\n\n\nCódigo\nESTACOES_tub = stops_as_sf(TUB$stops) # converter texto para geometria\nmapview(ESTACOES_tub) # visualizar as 1980 paragens\n\n\n\n\n\n\nE as 395 rotas (inclui variantes, idas e voltas):\n\n\nCódigo\nROTAS_tub = tidytransit::shapes_as_sf(TUB$shapes) # converter texto para geometria\nmapview(ROTAS_tub, zcol = \"shape_id\") # visualizar\n\n\n\n\n\n\nVamos fazer o mesmo desafio, mas com origem na paragem perto do IPCA (Monsenhor Airosa).\n\nDia útil em hora de ponta\nFiltramos os dados para o dia de hoje, quarta-feira, entre as 7h30 e as 9h00, e calculamos a duração da viagem mais rápida entre a estação Baixa-Chiado e todas as outras.\n\n\nCódigo\nstop_times_tub1 = filter_stop_times(TUB, \"2025-05-27\", \"07:30:00\", \"09:00:00\")\nduracao_viagem1 = travel_times(stop_times_tub1, \"MONSENHOR AIROSA\", stop_dist_check = FALSE)\n\nnrow(duracao_viagem1)\n\n\n[1] 935\n\n\nCódigo\nsummary(duracao_viagem1$travel_time/60) # resumo em minutos\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00   22.68   32.33   32.47   41.88   63.67 \n\n\nSem contar com o tempo de espera nparagem inicial, é possível alcançar 935 estações da rede (47%) em menos de 64 minutos (1h04), em hora de ponta - no intervalo de 1h30 definido.\n\nOutras estatísticas\n\n\nCódigo\nhist(duracao_viagem1$travel_time/60, breaks = 20) # histograma\nabline(v = mean(duracao_viagem1$travel_time/60), col = \"red\") # linha de média\nabline(v = median(duracao_viagem1$travel_time/60), col = \"blue\") # linha de mediana\n\n\n\n\n\n\n\n\n\nCódigo\nround(prop.table(table(duracao_viagem1$transfers))*100, 1) # percentagem de transferências\n\n\n\n   0    1    2    3    4 \n 6.0 56.3 33.8  3.9  0.1 \n\n\nApenas 6% das paragens são alcançáveis diretamente (sem transferência de autocarro). 62% são alcançáveis com 1 transferência no máximo, e 4% das paragens necessitam de 4 autocarros para ser alcançadas (3 transferências).\n\n\n\nDomingo de noite\nFiltramos os dados para o próximo Domingo entre as 20h00 e as 22h00, e novamente calculamos a duração da viagem mais rápida entre as paragens de autocarro do Cais do Sodré e todas as outras\n\n\nCódigo\nstop_times_tub2 = filter_stop_times(TUB, \"2025-06-01\", \"20:00:00\", \"22:00:00\")\nduracao_viagem2 = travel_times(stop_times_tub2, \"MONSENHOR AIROSA\", stop_dist_check = FALSE)\n\nnrow(duracao_viagem2)\n\n\n[1] 398\n\n\nCódigo\nsummary(duracao_viagem2$travel_time/60) # resumo em minutos\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00   19.83   25.48   26.68   34.10   55.80 \n\n\nNum Domingo de noite, é possível alcançar 398 estações da rede (20%) em menos de 56 minutos.\n\n\nVisualizar dados num mapa\nPodemos criar dois mapas que comparem o tempo que cada paragem demora a alcançar, a partir do IPCA, para os períodos definidos.\nJuntamos primeiro os tempos estimados aos dados georreferenciados das estações\n\n\nCódigo\n# hora de ponta\nduracao_viagem_TUB_HP = ESTACOES_tub |&gt; \n  left_join(duracao_viagem1, by = c(\"stop_id\" = \"to_stop_id\")) |&gt;  # juntar os dados \n  filter(transfers &gt;= 1) |&gt; # remover viagens com mais de 1 transferência\n  filter(travel_time &lt; 60*60) # remover viagens com mais de 60 minutos\n\n# domingo de noite\nduracao_viagem_TUB_Dom = ESTACOES_tub |&gt; \n  left_join(duracao_viagem2, by = c(\"stop_id\" = \"to_stop_id\")) |&gt;  # juntar os dados \n  filter(transfers &gt;= 1) |&gt; # remover viagens com mais de 1 transferência\n  filter(travel_time &lt; 60*60) |&gt;  # remover viagens com mais de 60 minutos\n  mutate(intervalo = case_when(\n    travel_time &lt; 15*60 ~ \"até 15 min\",\n    travel_time &lt; 30*60 ~ \"até 30 min\",\n    travel_time &lt; 45*60 ~ \"até 45 min\",\n    TRUE ~ \"até 60 min\"\n  )) # criar uma variável com o intervalo de tempo\n\n\nE “colorimos” o tempo de viagem que demora (no mínímo) a alcançar cada estação\n\n\nCódigo\nggplot(duracao_viagem_TUB_HP) +\n  geom_sf(aes(color = travel_time/60))+\n  ggtitle(\"Alcance desde o IPCA (TUB)\",\n          subtitle = \"às 7h30 de Terça, 27 Maio 2025 - máx 1 transf\") +\n  labs(color = \"Tempo de viagem [min]\") +\n  geom_sf(data = MONSENHORAIROSA, fill = \"black\", size = 5) + # destacar a paragem do IPCA\n  geom_sf(data = BragaGEO,\n          fill = \"transparent\",\n          color = \"grey30\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nCódigo\nggplot(duracao_viagem_TUB_Dom) +\n  geom_sf(aes(color = intervalo))+ # mudar para escala discreta\n  scale_color_manual(values = c(\"até 15 min\" = \"#119da4\",\n                                \"até 30 min\" = \"#0c7489\", \n                                \"até 45 min\" = \"#13505B\",\n                                \"até 60 min\" = \"#040404\")) +\n  ggtitle(\"Alcance desde o IPCA (TUB)\",\n          subtitle = \"às 20h30 de Domingo, 1 Junho 2025 - máx 1 transf\") +\n  labs(color = \"Tempo de viagem [min]\") +\n  geom_sf(data = MONSENHORAIROSA, fill = \"black\", size = 5) + # destacar a paragem do IPCA\n  geom_sf(data = BragaGEO,\n          fill = \"transparent\",\n          color = \"grey30\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nComo podemos visualmnente comparar, em hora de ponta é possível chegar de autocarro a bem mais paragens que num Domingo de noite.\n\n\n\n\n\n\nTPC\n\n\n\nExperimente importar, explorar e visualizar os dados GTFS da Carris Metropolitana.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Análise de GTFS</span>"
    ]
  },
  {
    "objectID": "r5r.html",
    "href": "r5r.html",
    "title": "4  Acessibilidade com r5r",
    "section": "",
    "text": "4.1 Isócronas\nCom base nos dados GTFS do Metro e Carris, vamos estimar isócronas e acessibilidade à população residente em Lisboa, a partir da Baixa.\nPara tal, iremos usar o pacote r5r (Pereira et al. 2021).\nO r5r cria um modelo através da combinação dos seguintes ficheiros na mesma pasta:",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Acessibilidade com r5r</span>"
    ]
  },
  {
    "objectID": "r5r.html#isócronas",
    "href": "r5r.html#isócronas",
    "title": "4  Acessibilidade com r5r",
    "section": "",
    "text": "4.1.1 Em Hora de Ponta\nNuma quarta-feira às 7h30, quanto tempo demoro a chegar ao território de Lisboa, usando Metro, Autocarro, e ligações a pé?\n\nCom 1 transferência\n\n\n\nSem transferências\n\n\n\n\n4.1.2 Num Domingo à noite\nE num Domingo às 22h00, quanto tempo demoro a chegar ao território de Lisboa, usando Metro, Autocarro, e ligações a pé?\n\nCom 1 transferência\n\n\n\nSem transferências",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Acessibilidade com r5r</span>"
    ]
  },
  {
    "objectID": "r5r.html#acessibilidade-à-população",
    "href": "r5r.html#acessibilidade-à-população",
    "title": "4  Acessibilidade com r5r",
    "section": "4.2 Acessibilidade à população",
    "text": "4.2 Acessibilidade à população\nCom base nos dados dos Censos 2021 (INE 2022), podemos também “contar” quantas pessoas são alcançáveis no território.\n\nCom 1 transferência\n\n\n\nHora de Ponta\nDomingo à noite\n\n\n\n\n35.9% em 30 min\n20.9% em 30 min\n\n\n83.6% em 45 min\n43.7% em 45 min\n\n\n97.4% em 60 min\n61.6% em 60 min\n\n\n\n\n\nSem transferências\n\n\n\nHora de Ponta\nDomingo à noite\n\n\n\n\n22.8% em 30 min\n17.6% em 30 min\n\n\n68.2% em 45 min\n38.2% em 45 min\n\n\n89.7% em 60 min\n51.7% em 60 min\n\n\n\nComo seria de esperar, em hora de ponta é possível alcançar mais residentes.\nPodemos também visualizar que população é acedida:\n\n\n\n\n\n\n\nDica\n\n\n\nPodemos também avaliar o acesso a escolas, ou outros POIs (pontos de interesse).\n\n\n\n\n\n\n\n\nINE. 2022. «Censos 2021- XVI Recenseamento Geral da População. VI Recenseamento Geral da Habitação». Lisboa: Instituto National de Estatística. https://censos.ine.pt/xurl/pub/65586079.\n\n\nPereira, Rafael H. M., Marcus Saraiva, Daniel Herszenhut, Carlos Kaue Vieira Braga, e Matthew Wigginton Conway. 2021. «r5r: Rapid Realistic Routing on Multimodal Transport Networks with R5 in R». Findings, março. https://doi.org/10.32866/001c.21262.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Acessibilidade com r5r</span>"
    ]
  },
  {
    "objectID": "r5r.html#footnotes",
    "href": "r5r.html#footnotes",
    "title": "4  Acessibilidade com r5r",
    "section": "",
    "text": "Ver como exportar em HOT export tool.↩︎\nOpcional.↩︎\nOpcional.↩︎",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Acessibilidade com r5r</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "Referências",
    "section": "",
    "text": "INE. 2022. “Censos 2021- XVI Recenseamento\nGeral da População. VI Recenseamento Geral da Habitação.”\nLisboa: Instituto National de Estatística. https://censos.ine.pt/xurl/pub/65586079.\n\n\nPereira, Rafael H. M., Marcus Saraiva, Daniel Herszenhut, Carlos Kaue\nVieira Braga, and Matthew Wigginton Conway. 2021. “R5r: Rapid\nRealistic Routing on Multimodal Transport Networks with r5 in\nr.” Findings, March. https://doi.org/10.32866/001c.21262.\n\n\nThe Open Data Institute. 2013. Guide: The Open Data Consumer\nChecklist. https://theodi.org/insights/guides/the-open-data-consumer-checklist/.",
    "crumbs": [
      "Referências"
    ]
  },
  {
    "objectID": "software.html",
    "href": "software.html",
    "title": "Software",
    "section": "",
    "text": "R\nNeste capítulo vamos guiá-lo através da instalação do R, do RStudio e dos pacotes necessários para obter os resultados apresentados nestes materiais.\nO R e o RStudio são softwares que necessitam de download e instalação separados.\nO R ou R stats (como também é conhecido) é uma linguagem de programação e um ambiente de software livre para computação estatística e gráficos apoiado pela R Foundation for Statistical Computing.\nOs links para download estão no The Comprehensive R Archive Network (aka CRAN). A versão mais recente é a 4.5.0, mas pode usar &gt;= 4.1.x se já a tiver instalada.\nApós esta instalação, não é necessário abrir o R. Prossiga com a instalação do RStudio.",
    "crumbs": [
      "Software"
    ]
  },
  {
    "objectID": "software.html#r",
    "href": "software.html#r",
    "title": "Software",
    "section": "",
    "text": "WindowsMac\n\n\nDownload R-4.5.0 para Windows e correr o ficheiro executável.\n\n\n\n\n\n\nImportante\n\n\n\nDeverá também instalar o Rtools, que é uma coleção de ferramentas necessárias para construir pacotes R no Windows.\nEscolha o segundo link para processador ARM (mais recente), e o primeiro link caso contrário.\n\n\n\n\nDownload R-4.5.0 para MacOX. Terá de escolher entre a versão arm64 ou a versão x86-64.\nTransfira o ficheiro .pkg e instale-o como habitualmente.",
    "crumbs": [
      "Software"
    ]
  },
  {
    "objectID": "software.html#rstudio",
    "href": "software.html#rstudio",
    "title": "Software",
    "section": "RStudio",
    "text": "RStudio\nO RStudio Desktop é um ambiente de desenvolvimento integrado (IDE) para o R. Inclui uma consola, um editor de código com realce para as funções de bases, bem como ferramentas para fazer gráficos, e análises estatísticas.\nO RStudio está disponível para descarregamento gratuito em Posit RStudio.\n\nWindows 10/11MacOS\n\n\nDownload RStudio 2025.05 e correr o ficheiro executável.\n\n\nDownload RStudio 2025.05 e instale-o como habitualmente.",
    "crumbs": [
      "Software"
    ]
  },
  {
    "objectID": "software.html#pacotes-de-r",
    "href": "software.html#pacotes-de-r",
    "title": "Software",
    "section": "Pacotes de R",
    "text": "Pacotes de R\nTerá de instalar alguns pacotes para trabalhar com os dados e os scripts destas aulas.\nPode instalá-los no RStudio procurando por eles no separador Packages:\n\nou executando o seguinte código (um a um) na consola:\n\ninstall.packages(\"tidyverse\")\ninstall.packages(\"readxl\")\n\ninstall.packages(\"sf\")\ninstall.packages(\"mapview\")\ninstall.packages(\"tidytransit\")\ninstall.packages(\"gtfsrouter\") # opcional\n\ninstall.packages(\"r5r\")\ninstall.packages(\"interp\")\ninstall.packages(\"rJavaEnv\")\n\ninstall.packages(\"rmarkdown\") # opcional\ninstall.packages(\"osmextract\") # opcional\ninstall.packages(\"stplanr\") # opcional",
    "crumbs": [
      "Software"
    ]
  },
  {
    "objectID": "software.html#java-development-kit",
    "href": "software.html#java-development-kit",
    "title": "Software",
    "section": "Java Development Kit",
    "text": "Java Development Kit\nPara utilizar o pacote {r5r} é necessário ter o Java Development Kit (JDK) 21 instalado no computador. Existem inúmeras implementações de código aberto do JDK. A maneira mais fácil de instalar o JDK é usando o novo pacote {rJavaEnv} no R.\n\n# verificar a versão de Java atualmente instalada (se existir) \nrJavaEnv::java_check_version_rjava()\n\n## se esta for a primeira vez que utiliza {rJavaEnv}, poderá ter de executar\n## este código abaixo para consentir a instalação de Java\nrJavaEnv::rje_consent(provided = TRUE)\n\n# instalar Java 21\nrJavaEnv::java_quick_install(version = 21)\n\n# verificar se o Java foi instalado com sucesso\nrJavaEnv::java_check_version_rjava()\n\nEm alternativa, pode transferir e instalar manualmente o JDK 21.\n\nWindows e MacOS\n\n\nAceda a Java Development Kit 21, transfira a última versão 21 correspondente ao seu sistema operativo e execute o ficheiro executável.",
    "crumbs": [
      "Software"
    ]
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Sobre",
    "section": "",
    "text": "Rosa Félix\nInvestigadora Senior e Professora convidada\nCERIS, Instituto Superior Técnico - Universidade de Lisboa\nWebsite | Google Scholar | Twitter | GitHub | Linkedin\nShort bio\nRosa Félix é investigadora sénior de pós-doutoramento e Proferssora Convidada no Instituto Superior Técnico - Universidade de Lisboa e membro do laboratório U-Shift, no Grupo de Investigação em Transportes do CERIS. Com formação em Engenharia de Planeamento Urbano, concluiu o doutoramento em Sistemas de Transportes em 2019 no Instituto Superior Técnico (programa MIT Portugal), e foi Visiting Scholar na Portland State University em 2017/18.\nRosa é uma investigadora na área da mobilidade ativa, e distingue-se em R e GIS. É uma entusiasta da utilização de código aberto e investigação reproduzível. As suas publicações incluem artigos sobre utilização da bicicleta e mudança de comportamentos, e soluções de código aberto para problemas específicos de SIG e mobilidade. Todos os anos, Rosa lecciona um curso de planeamento e conceção de infra-estruturas cicláveis para profissionais, e também ensina SIG para Transportes e Introdução à programação no Mestrado em Sistemas de Transportes.\nRosa tem trabalhado em múltiplos projetos de I&D e consultoria com municípios e indústria, como a Câmara Municipal de Lisboa (2019-2022) e a Transportes Metropolitanos de Lisboa (2023), no qual desenvolveu uma ferramenta digital para apoiar o planeamento da rede ciclável metropolitana, o biclaR, em colaboração com o Institute for Transport Studies da Universidade de Leeds.",
    "crumbs": [
      "Sobre"
    ]
  }
]